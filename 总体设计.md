# 一、硬件选型

## 1、单片机处理器

* c51 or c52

## 2、超声波传感器

* 是在超声波检测过程中发射和接收超声波的装置。探头的性能直接影响超声波的特性，影响超声波的检测性能。

* 在超声检测中使用的探头，是利用材料的压电效应实现电能、声能转换的换能器。探头中的关键部件是晶片，晶片是一个具有压电效应的单晶或者多晶体薄片，它的作用是将电能和声能互相转换。

* 超声波传感器是将超声波信号转换成其它能量信号（通常是电信号）的传感器。超声波是振动频率高于20kHz的机械波。它具有频率高、波长短、绕射现象小，特别是方向性好、能够成为射线而定向传播等特点。超声波对液体、固体的穿透本领很大，尤其是在阳光不透明的固体中。超声波碰到杂质或分界面会产生显著反射形成反射回波，碰到活动物体能产生多普勒效应。

* 超声波传感器的主要性能指标包括：

  > 工作频率、工作温度、灵敏度、指向性

* 超声波是一种在弹性介质中的机械振荡，有两种形式：横向振荡（横波）及纵向振荡（纵波）。在工业中应用主要采用纵向振荡。超声波可以在气体、液体及固体中传播，其传播速度不同。另外，它也有折射和反射现象，并且在传播过程中有衰减。在空气中传播超声波，其频率较低，一般为几十KHZ，而在固体、液体中则频率可用得较高。在空气中衰减较快，而在液体及固体中传播，衰减较小，传播较远。利用超声波的特性，可做成各种超声传感器，配上不同的电路，制成各种超声测量仪器及装置，并在通讯，医疗家电等各方面得到广泛应用。

* 超声波测距原理

  超声波发射器向某一方向发射超声波，在发射时刻的同时开始计时，超声波在空气中传播，途中碰到障碍物就立即返回来，超声波接收器收到反射波就立即停止计时。超声波在空气中的传播速度为340m/s，根据计时器记录的时间t，就可以计算出发射点距障碍物的距离(s)，即：s=340t/2 。这就是所谓的时间差测距法。

  超声波测距的原理是利用超声波在空气中的传播速度为已知，测量声波在发射后遇到障碍物反射回来的时间，根据发射和接收的时间差计算出发射点到障碍物的实际距离。由此可见，超声波测距原理与雷达原理是一样的。

  测距的公式表示为：L=C×T

  式中L为测量的距离长度；C为超声波在空气中的传播速度；T为测量距离传播的时间差(T为发射到接收时间数值的一半)。

* 超声波传感器==主要材料==有压电晶体（电致伸缩）及镍铁铝合金（磁致伸缩）两类。

  电致伸缩的材料有锆钛酸铅（PZT）等。压电晶体组成的超声波传感器是一种可逆传感器，它可以将电能转变成机械振荡而产生超声波，同时它接收到超声波时，也能转变成电能，所以它可以分成发送器或接收器。

  有的超声波传感器既作发送，也能作接收。

  这里仅介绍==小型超声波传感器==，发送与接收略有差别，它==适用于在空气中传播==，工作频率一般为23-25KHZ及40-45KHZ。这类传感器适用于测距、遥控、防盗等用途。该种有T/R-40-16，T/R-40-12等（其中T表示发送，R表示接收，40表示频率为40KHZ，16及12表示其外径尺寸，以毫米计）。

  另有一种==密封式超声波传感器（MA40EI型）==。它的特点是具有防水作用（但不能放入水中），可以作料位及接近开关用，它的性能较好。超声波应用有三种基本类型，透射型用于遥控器，防盗报警器、自动门、接近开关等；分离式反射型用于测距、液位或料位；反射型用于材料探伤、测厚等。

* 超声波传感器主要由如下四个部分构成：

  - 发送器：通过振子（一般为陶瓷制品，直径约为15 mm）振动产生超声波并向空中幅射。
  - 接收器：振子接收到超声波时，根据超声波发生相应的机械振动，并将其转换为电能量，作为接收器的输出。
  - 控制部分：通过用集成电路控制发送器的超声波发送，并判断接收器是否接收到信号（超声波），以及已接收信号的大小。
  - 电源部分：超声波传感器通常采用电压为DC12V ± 10 % 或 24V ± 10 %外部直流电源供电，经内部稳压电路供给传感器工作。

* ![image-20210331155719613](C:\Users\LaoYao\AppData\Roaming\Typora\typora-user-images\image-20210331155719613.png)



​    ==淀池中淤泥深度和水位测量方法的研究-------------曹亚猛==

> ​		超声波换能器在测量系统中占据着重要地位,其性能的好坏直接影响系统测量的可靠性和准确性。超声波换能器按收发方式可分为分体式和一体式，按照结构又分为开放式和密封式。		
>
> ​		换能器的工作频率是测量系统的主要技术参数，它直接影响超声波的扩散和吸收损失，障碍物反射损失等。超声波换能器中心频率的选取主要考虑以下两点:
>
> (1）如果测量距离较远，则超声波在传播的时候能量损失就会相对增加，由于介质对声波的吸收与声波频率的平方成正比，为减少声波在传播时的损失，就需要降低超声波换能器的中心频率;
>
> (2〉由于换能器的中心频率越高，它的指向性就越好，分辨率也就越高，因而从被测物质表面的粗糙性和复杂性来看,中心频率越高则声波的波长越短,测量的分辨率就高,测量的准确性也就越高。
>
> ​		该系统在==检测淤泥界面==时，声波在水中传播，而且超声波探头需安置在水中，故需要选用==防水型探头==，在这里选用收发-一体的防水型探头，又因为淤泥表面比较复杂，对超声波能量吸收比较大，所以要选用颊率较高的探头，综合考虑之后最终选用==200kHz==的探头，==型号为TCF200-47TR1==。
>
> ​		在检测水面时，超声波探头至于水面上方，声波的传播介质是空气，反射界面为水面，频率为==40kHz==左右的超声波在空气中传播的效率最佳，故选用便宜的分体式的40kHz探头最为经济实惠，==型号为T-40-16和R-40-16==。本课题所选的两个探头的主要技术参数见图4-1和表4-2。
>
> ![image-20210331170524781](C:\Users\LaoYao\AppData\Roaming\Typora\typora-user-images\image-20210331170524781.png)
>
> ![image-20210331170600680](C:\Users\LaoYao\AppData\Roaming\Typora\typora-user-images\image-20210331170600680.png)

## 3、温度补偿模块

* 超声波速度与温度的关系如下：

  式中： r —气体定压热容与定容热容的比值，对空气为1.40，

  R —气体普适常量，8.314kg·mol-1·K-1，

  M—气体分子量，空气为28.8×10-3kg·mol-1，

  T —绝对温度，273K+T℃。

  近似公式为：C=C0+0.607×T℃

  式中：C0为零度时的声波速度332m/s；

  T为实际温度(℃)。

* 对于超声波测距精度要求达到1mm时，就必须把超声波传播的环境温度考虑进去。例如当温度0℃时超声波速度是332m/s,  30℃时是350m/s，温度变化引起的超声波速度变化为18m/s。若超声波在30℃的环境下以0℃的声速测量100m距离所引起的测量误差将达到5m，测量1m误差将达到5cm。

> ![image-20210331160505533](C:\Users\LaoYao\AppData\Roaming\Typora\typora-user-images\image-20210331160505533.png)
>
> ![image-20210331161107655](C:\Users\LaoYao\AppData\Roaming\Typora\typora-user-images\image-20210331161107655.png)

## 4、去噪模块

* 小波去噪方法

# 二、通讯方式（远程）

==水位泥位测量方法及装置的研究———左薪楠==

> ​		系统中该模块的目的是实现装置与上位机之间的数据通信，即通过上位机软件对AD采集电压、由主板处理后得到的水位和泥位值进行获取并显示，对参数进行设置、获取等数据之间的交互。在对通信模块设计之初，就系统适合使用哪种通信以及具体哪种标准进行了研究，最终选择了==RS-485==串行数据通信接口，接下来对其使用原因进行详细说明。
> ​		在通信领域内，有两种数据通信:并行通信和串行通信，其中，并行通信虽传输速度快，但却占用太多IO口，因此在中小型化工业产品的开发生产中并不适用，在进行远程通信时，串行通信的数据传输效率虽然低，但是在数据通信的吞吐量不是太大的情况下却更加地方便、简易、灵活，还具有节省传输线的优点，所以通常在工业开发生产中被广泛使用。
>
> 目前使用较多的是RS-232C标准和RS-485标准(S'的串行数据通信接口,对RS-232C和 RS-485进行了以下几个方面的比较:
>
> (1)两者均采用负逻辑信号，RS-485两线之间电压差为正（+2V~+6V) 表示逻辑“1”，电压差为负(-6V~-2V) 表示逻辑“0"”，RS-232C的高电平为+3V——+15V，低电平为-3V——-15Vl36l，由于RS-485接口电平信号低，因此不容易对后面接口电路的芯片造成损坏;
>
> (2）RS-485的传送速率最大可达到10Mbit/s，传输距离最长可达1200米，若须对传输过程中的传输距离不断增大，就可以通过不断增加中继从而对信号进行放大的方式来实现，而RS-232C仅有20kbit/s 的最高传输速率和15m的最大通信距离;
>
> (3)RS-485收发器具有良好的抗噪声干扰性;
>
> (4)使用RS-485通信接口构成的系统，一个发送驱动器最多可以驱动32个负载设备，也可经过特殊设计使其最大驱动128个负载设备，而RS-232C通信接口只能进行一对一的通信36]。
>
> 正是RS-485接口的这些优点，为它被广泛应用于工业领域奠定了一定的基础，而本测量装置系统最终也采用了 RS-485 串行数据通信接口。
>
> ![image-20210331165916060](C:\Users\LaoYao\AppData\Roaming\Typora\typora-user-images\image-20210331165916060.png)





> NB-IoT
>
> NB-IoT是IoT领域一个新兴的技术，支持低功耗设备在广域网的蜂窝数据连接，也被叫作低功耗广域网(LPWAN)。NB-IoT支持待机时间长、对网络连接要求较高设备的高效连接。NB-IoT设备的电池寿命可以长达10年，同时还能提供非常全面的室内蜂窝数据连接覆盖，一个小区内可以覆盖数万节点。
>
> ==LoRa==
>
> LoRa（长距离）是由Semtech公司开发的一种扩频调制技术，典型工作频率在美国是915MHz，在欧洲是868MHz，在亚洲是433/470MHz。其典型范围是2km至5km，最长距离可达15km，具体取决于所处的位置和天线特性。
>
> ZigBee
>
> ZigBee是 物联网的理想选择之一。ZigBee是一种无线连接，可工作在2.4GHz(全球流行)、868MHz(欧洲流行)和915  MHz(美国流行)3个频段上,分别具有最高250kbit/s、20kbit/s和40kbit/s的传输速率，它的传输距离与功耗挂钩，大功率模块甚至可以到达几公里以上。ZigBee技术是一种近距离、低复杂度、低功耗、低速率、低成本的双向无线通讯技术。
>
> Wi-Fi
>
> Wi-Fi被广泛用于许多物联网应用案例，最常见的是作为从网关到连接互联网的路由器的链路。然而，它也被用于要求高速和中距离的主要无线链路。大多数Wi-Fi版本工作在2.4GHz免许可频段，传输距离长达100米，具体取决于应用环境。流行的802.11n速度可达300Mb/s，而更新的、工作在 5GHz ISM频段的802.11ac，速度甚至可以超过1.3Gb/s。
>
> ![img](https://images2015.cnblogs.com/blog/841846/201608/841846-20160823101410433-2133870495.png)



> 无线通信的方式
>  主要有蓝牙、RFID、NFC、ZIGBEE、WIFI、IrDA、微波、2G/3G/4G/5G等。
>
> 蓝牙
>   蓝牙技术是无线技术和语音通信的全球规范，基于低成本的近距离的无线连接，为固定和移动设备建立通信环境的一种特殊的近距离无线技术连接。Bluetooth通信距离在10m内。蓝牙工作在全球通用的2.4GHz ISM（即工业、科学、医学）频段，使用IEEE802.15协议可容纳的设备不能超过8台。
>  蓝牙1.2传输速度为721Kbps，蓝牙2.0最高速度为2.1Mbps，蓝牙2.1传输速率可达2～3Mbps，这只是理论数据，实际应用中由于设备间的兼容性以及其他因素影响很难实现，一般在100KB左右。 蓝牙3.0和4.0的最高速度是24Mbps。
>
> RFID
>  射频识别（RFID）是 Radio Frequency Identification 的缩写，手持机一般读距离在5cm—10cm，距离跟频率有关系，高频：近距离在5–10cn，中距离5–30cm，远距离30—120cm ，超高频0–30m
>
> NFC
>   NFC的传输速度有三种可以选择：106kbps、212kbps或424kbps,与RFID一样，NFC信息也是通过频谱中无线频率部分的电磁感应耦合方式传递，但两者之间还是存在很大的区别。由于NFC采取了独特的信号衰减技术，相对于RFID来说NFC具有距离近、带宽高、能耗低等特点。其次，NFC与现有非接触智能卡技术兼容。
>
> ZIGBEE
>  工作在2.4GHz频段，最远传输距离1000m，是否带PA表示是发射功率是否放大，通信速率250kbps
>  WIFI
>  数据传输速率可达到54Mbps，相比蓝牙，wifi具有更大的覆盖范围和更高的传输速率。
>
> 红外IrDA
>  IrDA (The Infrared Data  Association，红外数据协会)。根据所能达到的最大传输速率的不同，常用的IrDA有两种：SIR（Slow  Infrared）和FIR（Fast Infrared）。SIR最大传输速率为115.2Kbps，而FIR的传输速率可达4Mbps。
>
> 微波
>  微波通信（Microwave Communication），是使用波长在0.1毫米至1米之间的电磁波——微波进行的通信。该波长段电磁波所对应的频率范围是300MHz至3000GHz。
>
> 2G.3G.4G
>  无线网络和3G技术的区别就是3G在高速移动时传输质量较好，但静态的时候用Wi-Fi上网足够了。



> **Zigbee**
>
> **通讯频段：**免执照频段。使用工业科学医疗(ISM)频段，915MHz(美国), 868MHz(欧洲), 2. 4GHz(全球) 
> **通讯距离：**传输范围一般介于10～100m之间，在增加发射功率后，亦可增加到1～3km。这指的是相邻节点间的距离。如果通过路由和节点间通信的接力，传输距离将可以更远
> **功耗：**低
> **传输速率：**20～250kbps
> **说明：**近距离、高可靠、低复杂度、低功耗、低数据速率、低成本的无线网络技术，主要用于近距离无线连接。在整个网络范围内，每一个ZigBee网络数传模块之间可以相互通信，每个ZigBee网络节点不仅本身可以作为监控对象，例如其所连接的传感器直接进行数据采集和监控，还可以自动中转别的网络节点传过来的数据资料。除此之外，每一个ZigBee网络节点还可在自己信号覆盖的范围内，和多个不承担网络信息中转任务的孤立的子节点无线连接。
>
>  **Bluetooth（蓝牙）**
>
> **通讯频段：**免执照频段。工业、科学和医疗用（ISM）波段的 2.4 GHz 短距离无线电频段
> **通讯距离：**最大100m，范围取决于功率
> **功耗：**相比Zigbee来说比较大
> **传输速率：**蓝牙2.0的速度:1.8M/s，蓝牙3.0的速度:可达24M/s，蓝牙4.0的速度:24M/s
> **说明：**蓝牙使用跳频技术，将传输的数据分割成数据包，通过79个指定的蓝牙频道分别传输数据包。每个频道的频宽为1 MHz。蓝牙4.0使用2 MHz 间距，可容纳40个频道。蓝牙主设备最多可与一个微微网中的七个设备通讯,  设备之间可通过协议转换角色，从设备也可转换为主设备。
>
>  **WIFI**
>
> **通讯频段：**免执照
> **通讯距离：**取决于路由器
> **功耗：**较大
> **传输速率：**54Mbps
> **说明：**无线网络在无线局域网的范畴是指“无线相容性认证”，实质上是一种商业认证，同时也是一种无线联网技术，常见的就是一个无线路由器，那么在这个无线路由器的电波覆盖的有效范围都可以采用Wi-Fi连接方式进行联网，如果无线路由器连接了一条ADSL线路或者别的上网线路，则又被称为热点。WIFI的数据安全性比较差。
>
>  **NB-IOT**
>
> **通讯频段：**沿用LTE定义的频段号（根据运营商）
> **通讯距离：**15km
> **功耗：**低
> **传输速率：**大于160kbps,小于250kbps
> **说明：**NB-IoT构建于蜂窝网络，只消耗大约180KHz的带宽，可直接部署于GSM网络、UMTS网络或LTE网络。NB-IoT是IoT领域一个新兴的技术，支持低功耗设备在广域网的蜂窝数据连接，也被叫作低功耗广域网(LPWAN)。支持待机时间长、对网络连接要求较高设备的高效连接。同时还能提供非常全面的室内蜂窝数据连接覆盖。远距离、低功耗、半双工通讯是其特点。
>
>  **LoRa**
>
> **通讯频段：**ISM 频段 包括433、868、915 MH等
> **通讯距离：**城镇2-5 km ，郊区15 km
> **功耗：**低
> **传输速率：**速率越快，传输距离会缩短，通常使用1.1kbps
> **说明：**LoRa由美国公司SEMTECH独家私有技术垄断，终端和网关芯片IP专利由SMETCH独家掌控，最大特点就是在同样的功耗条件下比其他无线方式传播的距离更远，实现了低功耗和远距离的统一，它在同样的功耗下比传统的无线射频通信距离扩大3-5倍。
>
>  **RFID**
>
> **通讯频段：**低频（125KHz到135KHz），高频（13.56MHz）和超高频（860MHz到960MHz）之间
> **通讯距离：**几十米
> **功耗：**低
> **传输速率：**取决于代码的长度、载体数据发送速率、读写距离、载体与天线间载波频率，以及数据传输的调制技术等因素。传输速率随实际应用中产品种类的不同而不同。
> **说明：**无线射频识别技术(Radio Frequency Idenfication，即RFID)是一种非接触的自动识别技术。其基本原理是利用射频信号和空间耦合(电感或电磁耦合)或雷达反射的传输特性，实现对被识别物体的自动识别。
>
>  **NFC**
>
> **通讯频段：**13.56MHz
> **通讯距离：**小于10cm
> **功耗：**低
> **传输速率：**取决于代码的长度、载体数据发送速率、读写距离、载体与天线间载波频率，以及数据传输的调制技术等因素。传输速率随实际应用中产品种类的不同而不同
> **说明：**NFC是在RFID的基础上发展而来，NFC从本质上与RFID没有太大区别，都是基于地理位置相近的两个物体之间的信号传输。NFC技术增加了点对点通信功能，可以快速建立蓝牙设备之间的P2P（点对点）无线通信，NFC设备彼此寻找对方并建立通信连接。NFC通信的双方设备是对等的，而RFID通信的双方设备是主从关系。NFC因为通讯距离端，因此安全性很高。
>
>  **4G**
>
> **通讯频段：**根据运营商
> **通讯距离：**根据基站
> **功耗：**较高
> **传输速率：**100Mbps
> **说明：**包括TD-LTE和FDD-LTE两种制式。

# 三、软件设计

做一个web页面来展示数据，同时可实现数据查询与下载功能

# 四、数据库

* 数据库选择：MySQL

* 数据库表单格式：

  ​																						水仓淤泥高度表

| id   | high_1 | high_2 | high_3 | high_4 | time |
| ---- | ------ | ------ | ------ | ------ | ---- |
|      |        |        |        |        |      |

​																								用户表

| id   | User_name | password | sex  | email | phone |
| ---- | --------- | -------- | ---- | ----- | ----- |
|      |           |          |      |       |       |





# ##一些资料

## 1、矿井水仓

矿井主要水仓指的是煤矿井底车场附近积存矿井涌水的巷道和硐室。所谓矿井排水就是将矿井主要水仓中的水排到地面。矿井主要水仓设置合理与否，关系到排水系统排水能力能否正常发挥。《煤矿防治水规定》第六十条至第六十五条对主要水仓进行了规定。

1．矿井主要水仓应当有主仓和副仓，当一个水仓清理时，另一个水仓能够正常使用，防止因泥沙、煤矸、碎屑堵塞水仓，保证水仓的设计容量。

2．新建、改扩建矿井或者生产矿井的新水平，正常涌水量在1000 m³/h以下时，主要水仓的有效容量应当能容纳8h的正常涌水量。

3．正常涌水量大于1000 m³/h的矿井，主要水仓有效容量可以按照下式计算：

V=2 (Q+3000)  (4-2-6)

式中V-主要水仓的有效容量，m³；

Q-矿井每小时的正常涌水量，m³。

4．采区水仓的有效容量应当能容纳4h的采区正常涌水量。

5．矿井最大涌水量与正常涌水量相差特别大的矿井，排水能力和水仓容量应当由有资质的设计单位编制专门设计，由煤矿企业总工程师组织审查批准。

6．水仓进口处应当设置箅子。对水砂充填、水力采煤和其他涌水中带有大量杂质的矿井，还应当设置沉淀池。

7．矿井主要水仓、沉淀池和水沟中的淤泥，应当及时清理；每年雨季前，应当清理1次，使水仓的空仓容量应当经常保持在==总容量的50%以上==。

8．对于采用平硐泄水的矿井，其平硐的总过水能力应当不小于历年最大渗入矿井水量的1.2倍；水沟或者泄水巷的标高，应当比主运输巷道的标高低。

 9．在水文地质条件复杂、极复杂矿区建设新井的，应当在井筒底留设潜水泵窝，老矿井也应当改建增设潜水泵窝。井筒开凿到底后，井底附近应当设置具有一定能力的临时排水设施，保证临时变电所、临时水仓形成之前的施工安全。

10．对于在建矿井，在永久排水系统形成前，各施工区应当设置临时排水系统，并保证有足够的排水能力。

11．生产矿井延深水平，只有在建，新水平的防、排水系统后，方可开拓掘进。

12、==矿井主要水仓应当有主仓和副仓，当一个水仓清理时，另一个水仓能够正常使用。==

## 2、传感器

> ==TCF200-47TR1==



![image-20210401110748763](C:\Users\LaoYao\AppData\Roaming\Typora\typora-user-images\image-20210401110748763.png)

